{% set version = "0.2.6" %}
package:
  name: "bioformats2raw"
  version: "{{ version }}"

build:
  number: 0

source:
  url: https://github.com/glencoesoftware/bioformats2raw/releases/download/v{{ version }}/bioformats2raw-{{ version }}.zip
  sha256: 3845453e495f118783d13122eba8a3997a45bef82ac4f08c711b8deae22ef8b2
  patches:
    - windows-bat-classpath-wildcard.patch  # [win]

requirements:
  build:
    - m2-patch  # [win]
  run:
    - bioformats2raw-libs={{ PKG_VERSION }}-{{ PKG_BUILDNUM }}
    # Fails with openjdk 11 on Windows
    # https://github.com/ome/conda-bioformats2raw/issues/3
    - openjdk=8  # [win]
    - openjdk  # [not win]

test:
  commands:
    - bioformats2raw a.fake output
    - bioformats2raw --file_type=zarr -r 2 a.fake output.zarr

extra:
  recipe-maintainers:
    - ome

about:
  home: https://www.openmicroscopy.org/
  license: GNU General Public v2 or later (GPLv2+)
  license_family: GPL2
  summary: Bio-Formats image file format to raw format converter
  dev_url: https://github.com/glencoesoftware/bioformats2raw/
